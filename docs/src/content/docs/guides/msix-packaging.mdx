# MSIX Packaging (Windows)

Wails v3 can generate modern **MSIX** installers for Windows applications, providing a cleaner, safer and Store-ready alternative to traditional **NSIS** or plain `.exe` bundles.

This guide walks through:

* Prerequisites & tool installation  
* Building your app as an MSIX package  
* Signing the package  
* Command-line reference  
* Troubleshooting  

---

## 1. Prerequisites

| Requirement | Notes |
|-------------|-------|
| **Windows 10 1809+ / Windows 11** | MSIX is only supported on Windows. |
| **Windows SDK** (for `MakeAppx.exe` & `signtool.exe`) | Install from the [Windows SDK download page](https://developer.microsoft.com/windows/downloads/windows-sdk/). |
| **Microsoft MSIX Packaging Tool** (optional) | Available from the Microsoft Store – provides a GUI & CLI. |
| **Code-signing certificate** (recommended) | A `.pfx` file generated by your CA or `New-SelfSignedCertificate`. |

> **Tip:** Wails ships a Task that opens the download pages for you:

```bash
# installs MakeAppx / signtool (via Windows SDK) and the MSIX Packaging Tool
wails3 task windows:install:msix:tools
```

---

## 2. Building an MSIX package

### 2.1 Quick CLI

```bash
# Production build + MSIX
wails3 tool msix \
  --name MyApp                   \  # executable name
  --executable build/bin/MyApp.exe \
  --arch x64                     \  # x64, x86 or arm64
  --out build/bin/MyApp-x64.msix
```

The command will:

1. Create a temporary layout (`AppxManifest.xml`, `Assets/`).
2. Call **MakeAppx.exe** (default) or **MsixPackagingTool.exe** if `--use-msix-tool` is passed.
3. Optionally sign the package (see §3).

### 2.2 Using the generated Taskfile

When you ran `wails init`, Wails created `build/windows/Taskfile.yml`.  
Packaging with MSIX is a one-liner:

```bash
# default=nsis, override FORMAT
wails3 task windows:package FORMAT=msix
```

Output goes to `build/bin/MyApp-<arch>.msix`.

---

## 3. Signing the package

Windows will refuse unsigned MSIX packages unless you enable developer-mode, so signing is strongly recommended.

```bash
wails3 tool msix \
  --cert build/cert/CodeSign.pfx \
  --cert-password "pfx-password" \
  --publisher "CN=MyCompany" \
  --out build/bin/MyApp.msix
```

* If you pass `--cert`, Wails automatically runs `signtool sign …`.
* `--publisher` sets the `Publisher` field inside `AppxManifest.xml`.  
  It **must** match the subject of your certificate.

---

## 4. Command-line reference

| Flag | Default | Description |
|------|---------|-------------|
| `--config` | `wails.json` | Project config with **Info** & `fileAssociations`. |
| `--name` | — | Executable name inside the package (no spaces). |
| `--executable` | — | Path to the built `.exe`. |
| `--arch` | `x64` | `x64`, `x86`, or `arm64`. |
| `--out` | `<name>.msix` | Output path / filename. |
| `--publisher` | `CN=<CompanyName>` | Publisher string in the manifest. |
| `--cert` | ― | Path to `.pfx` certificate for signing. |
| `--cert-password` | ― | Password for the `.pfx`. |
| `--use-msix-tool` | `false` | Use **MsixPackagingTool.exe** instead of **MakeAppx.exe**. |
| `--use-makeappx` | `true` | Force MakeAppx even if the MSIX Tool is installed. |

---

## 5. File associations

Wails automatically injects file associations declared in `wails.json` into the package manifest:

```json
"fileAssociations": [
  { "ext": "wails", "name": "Wails Project", "description": "Wails file", "role": "Editor" }
]
```

After installation, Windows will offer your app as a handler for these extensions.

---

## 6. Troubleshooting

| Problem | Solution |
|---------|----------|
| `MakeAppx.exe not found` | Install the Windows SDK and restart the terminal. |
| `signtool.exe not found` | Same as above – both live in the SDK’s *bin* folder. |
| *Package cannot be installed because publisher mismatch* | The certificate subject (CN) must match `--publisher`. |
| *The certificate is not trusted* | Import the certificate into **Trusted Root Certification Authorities** or use a publicly trusted code-signing cert. |
| Need GUI | Install **MSIX Packaging Tool** from the store and run `MsixPackagingTool.exe`. The template generated by Wails is fully compatible. |

---

## 7. Next steps

* [Windows Installer (NSIS) guide](./windows-installer.mdx) – legacy format.  
* [Cross-platform update mechanism](../updates.mdx) – coming soon.  
* Join the community on Discord to share feedback!

Happy packaging!
